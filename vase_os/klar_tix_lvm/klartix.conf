# Configuration consts

# Host package manager for prerequisites
PKG_MAN="pacman"
PKG_MAN_W="-S"
ARG1="--noconfirm --needed"

# Init system selection (openrc, runit, s6, dinit)
INIT_SYSTEM="openrc"
# Tested openrc and runit boots fine, know nothing about s6 and dinit soz
#MIRROR_URL="https://archive.artixlinux.org/repos/2025/11/01"
# This lets us do version control testing by being in the past

# Prefs
TARGET_FS="ext4" # Filesystem: ext4, btrfs, xfs, f2fs
EFI_SIZE="1GiB" # Default

KB_LAYOUT="fr"
KB_VARIANT="azerty" # Optional variant: nodeadkeys, dvorak, etc. Leave empty for default
# Keyboard layout for both system and GRUB
# Examples: us, fr, de, be, uk, es, it, pt, dvorak
# Note: Non-US layouts will configure GRUB keymap automatically
#       GRUB only supports ASCII (1-127), so avoid extended characters in LUKS password
# Keymaps that have too many extended chars ARE UNSUPPORTED. ANd should be left to "us"

TARGET_TIMEZONE="Europe/Paris"
TARGET_HOSTNAME="vasex"

# Important stuff
SEPARATE_HOME=1 # 0=/home on root, 1=separate /home
USE_LVM=0 # 0=simple partitions (LUKS on root), 1=LVM on LUKS (default)
LOCK_ROOT=1 # 0=keep root login enabled, 1=lock root account (recommended for security)

# LUKS encryption settings
LUKS_ITER_TIME=512 # PBKDF2 iteration time in milliseconds (default: 1000, higher = more secure but slower boot)

# Kernel selection (linux, linux-lts, linux-zen, linux-hardened)
KERNEL="linux" # Options: linux, linux-lts, linux-zen, linux-hardened

# Modern LUKS layout with /efi mount and zram swap
ENABLE_LUKS=1 # Always enabled
# Use zram for swap instead of partition

# Partition layout: EFI (1GB) + LUKS container → LVM logical volumes OR simple partitions
# | Config        | EFI   | Boot         | Root      | Home      | Swap   | Prompts        |
# |---------------|-------|--------------|-----------|-----------|--------|----------------|
# | USE_LVM=1     | /efi | /boot (root) | LVM+LUKS  | LVM+LUKS  | zram   | 1 (GRUB only)  |
# | USE_LVM=0     | /efi | /boot (root) | LUKS only | LUKS only | zram   | 1 (GRUB only)  |
#
# Device mapping with LVM (USE_LVM=1):
# /dev/sdX1 → /efi (FAT32)
# /dev/sdX2 → LUKS → /dev/mapper/lvm-system → LVM VG → logical volumes
#
# Device mapping without LVM (USE_LVM=0):
# /dev/sdX1 → /efi (FAT32)
# /dev/sdX2 → LUKS → /dev/mapper/cryptroot (root partition)
# /dev/sdX3 → LUKS → /dev/mapper/crypthome (home partition, if SEPARATE_HOME=1)

################# REQUIRED PACKAGES

# LVM and encryption packages for all init systems
LVM_PACKAGES="lvm2 cryptsetup"
LVM_OPENRC="device-mapper-openrc lvm2-openrc cryptsetup-openrc"
LVM_RUNIT="device-mapper-runit lvm2-runit cryptsetup-runit"
LVM_S6="device-mapper-s6 lvm2-s6 cryptsetup-s6"
LVM_DINIT="device-mapper-dinit lvm2-dinit cryptsetup-dinit"

# Zram is built into kernel - no packages needed

################# HW GROUPS

# CPU Vendors & Microcode
HW_CPU_AMD="amd-ucode"
HW_CPU_INTEL="intel-ucode"

# All Open-Source Drivers
HW_ALL_OPENSOURCE="mesa xf86-video-amdgpu xf86-video-ati xf86-video-nouveau libva-mesa-driver libva-intel-driver intel-media-driver vulkan-radeon vulkan-intel vulkan-nouveau"

# AMD/ATI Graphics (Open-Source)
HW_AMD_OPENSOURCE="mesa xf86-video-amdgpu xf86-video-ati libva-mesa-driver vulkan-radeon"

# Intel Graphics (Open-Source)
HW_INTEL_OPENSOURCE="mesa libva-intel-driver intel-media-driver vulkan-intel"

# Nvidia Graphics - Proprietary Driver
HW_NVIDIA_PROPRIETARY="nvidia-dkms dkms"

# Nvidia Graphics - Open Kernel Module (Turing+)
HW_NVIDIA_OPEN_KERNEL="nvidia-open-dkms dkms"

# Nvidia Graphics - Open-Source (Nouveau)
HW_NVIDIA_OPENSOURCE="mesa xf86-video-nouveau libva-mesa-driver vulkan-nouveau"

# Hybrid Graphics - Nvidia Prime (Intel + Nvidia) iGPU + dGPU
HW_NVIDIA_PRIME="nvidia-prime"

# Virtual Machine - QEMU/KVM
HW_VM_QEMU="mesa vulkan-virtio qemu-guest-agent vulkan-swrast"

# Virtual Machine - VirtualBox
HW_VM_VIRTUALBOX="mesa vulkan-swrast virtualbox-guest-utils"

# Audio Firmware - SOF (Sound Open Firmware)
HW_AUDIO_SOF="sof-firmware"

# Audio Firmware - ALSA
HW_AUDIO_ALSA="alsa-firmware"